{"version":3,"file":"save-media.js","sources":["pages/API/save-media/save-media.vue","../../../../../Work-Tools/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNcQVBJXHNhdmUtbWVkaWFcc2F2ZS1tZWRpYS52dWU"],"sourcesContent":["<template>\r\n\t<view>\r\n\t\t<page-head :title=\"title\"></page-head>\r\n\t\t<view class=\"uni-padding-wrap\">\r\n\t\t\t<view v-if=\"imagePath !== ''\" class=\"media-box image\">\r\n\t\t\t\t<image class=\"image\" mode=\"widthFix\" :src=\"imagePath\" />\r\n\t\t\t</view>\r\n\t\t\t<button type=\"primary\"  class=\"uni-button\" @click=\"saveImage\">拍摄图片并保存到本地</button>\r\n\t\t\t<view v-if=\"videoPath !== ''\" class=\"media-box\">\r\n\t\t\t\t<video\r\n\t\t\t\t\tid=\"myVideo\"\r\n\t\t\t\t\t:src=\"videoPath\"\r\n\t\t\t\t\t@error=\"videoErrorCallback\"\r\n\t\t\t\t\tenable-danmu\r\n\t\t\t\t\tdanmu-btn\r\n\t\t\t\t\tcontrols\r\n\t\t\t\t></video>\r\n\t\t\t</view>\r\n\t\t\t<button type=\"primary\" class=\"uni-button\" @click=\"saveVideo\">录制视频并保存到本地</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script>\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttitle: 'saveImage/saveVideo',\r\n\t\t\timagePath: '',\r\n\t\t\tvideoPath: ''\r\n\t\t};\r\n\t},\r\n\tonLoad() {},\r\n\tmethods: {\r\n\t\tvideoErrorCallback: function() {\r\n\t\t\tuni.showModal({\r\n\t\t\t\tcontent: '视频加载失败',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t});\r\n\t\t},\r\n\t\tsaveImage() {\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 1,\r\n\t\t\t\tsourceType: ['camera'],\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tthis.imagePath = res.tempFilePaths[0];\r\n\t\t\t\t\tthis.getTempFilePath(res.tempFilePaths[0], 'imageTempPath');\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t// #ifdef MP\r\n\t\t\t\t\tuni.getSetting({\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tlet authStatus = res.authSetting['scope.camera'];\r\n\t\t\t\t\t\t\tif (!authStatus) {\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\ttitle: '授权失败',\r\n\t\t\t\t\t\t\t\t\tcontent: 'Hello uni-app需要从您的相机获取图片，请在设置界面打开相关权限',\r\n\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.openSetting()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tsaveVideo() {\r\n\t\t\tlet _this = this;\r\n\t\t\tuni.chooseVideo({\r\n\t\t\t\tcount: 1,\r\n\t\t\t\tsourceType: ['camera'],\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tconsole.log(res.tempFilePath)\r\n\t\t\t\t\tthis.videoPath = res.tempFilePath;\r\n\t\t\t\t\tthis.getTempFilePath(res.tempFilePath, 'videoTempPath');\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t// #ifdef MP\r\n\t\t\t\t\tuni.getSetting({\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tlet authStatus = res.authSetting['scope.camera'];\r\n\t\t\t\t\t\t\tif (!authStatus) {\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\ttitle: '授权失败',\r\n\t\t\t\t\t\t\t\t\tcontent: 'Hello uni-app需要从您的相机获取视频，请在设置界面打开相关权限',\r\n\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.openSetting()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tgetTempFilePath(url, types) {\r\n\t\t\t// 如果已经下载本地路径，那么直接储存\r\n\t\t\tlet obj = {\r\n\t\t\t\tfilePath: url,\r\n\t\t\t\tsuccess: () => {\r\n\t\t\t\t\tconsole.log('save success');\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: '保存成功',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t},\r\n\t\t\t\tfail: e => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: '保存失败',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '保存中...'\r\n\t\t\t});\r\n\t\t\tif (types === 'videoTempPath') {\r\n\t\t\t\tuni.saveVideoToPhotosAlbum(obj);\r\n\t\t\t} else {\r\n\t\t\t\tuni.saveImageToPhotosAlbum(obj);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style>\r\n.media-box {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tmargin: 30rpx 0;\r\n\twidth: 100%;\r\n}\r\n.image {\r\n\theight: 400rpx;\r\n\toverflow: hidden;\r\n}\r\n.image image {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\nvideo {\r\n\twidth: 100%;\r\n}\r\n.uni-button {\r\n\tmargin: 30rpx 0;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/workspace/2025/wx/wx20250829/天天体验馆/pages/API/save-media/save-media.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","res"],"mappings":";;AAuBA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,OAAO;AAAA,MACP,WAAW;AAAA,MACX,WAAW;AAAA;EAEZ;AAAA,EACD,SAAS;AAAA,EAAE;AAAA,EACX,SAAS;AAAA,IACR,oBAAoB,WAAW;AAC9BA,oBAAAA,MAAI,UAAU;AAAA,QACb,SAAS;AAAA,QACT,YAAY;AAAA,MACb,CAAC;AAAA,IACD;AAAA,IACD,YAAY;AACXA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,YAAY,CAAC,QAAQ;AAAA,QACrB,SAAS,SAAO;AACf,eAAK,YAAY,IAAI,cAAc,CAAC;AACpC,eAAK,gBAAgB,IAAI,cAAc,CAAC,GAAG,eAAe;AAAA,QAC1D;AAAA,QACD,MAAM,CAAC,QAAQ;AAEdA,wBAAAA,MAAI,WAAW;AAAA,YACd,SAAS,CAAC,QAAQ;AACjB,kBAAI,aAAa,IAAI,YAAY,cAAc;AAC/C,kBAAI,CAAC,YAAY;AAChBA,8BAAAA,MAAI,UAAU;AAAA,kBACb,OAAO;AAAA,kBACP,SAAS;AAAA,kBACT,SAAS,CAACC,SAAQ;AACjB,wBAAIA,KAAI,SAAS;AAChBD,oCAAAA,MAAI,YAAY;AAAA,oBACjB;AAAA,kBACD;AAAA,iBACA;AAAA,cACF;AAAA,YACD;AAAA,WACA;AAAA,QAEF;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IACD,YAAY;AAEXA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,YAAY,CAAC,QAAQ;AAAA,QACrB,SAAS,SAAO;AACfA,wBAAAA,gEAAY,IAAI,YAAY;AAC5B,eAAK,YAAY,IAAI;AACrB,eAAK,gBAAgB,IAAI,cAAc,eAAe;AAAA,QACtD;AAAA,QACD,MAAM,CAAC,QAAQ;AAEdA,wBAAAA,MAAI,WAAW;AAAA,YACd,SAAS,CAAC,QAAQ;AACjB,kBAAI,aAAa,IAAI,YAAY,cAAc;AAC/C,kBAAI,CAAC,YAAY;AAChBA,8BAAAA,MAAI,UAAU;AAAA,kBACb,OAAO;AAAA,kBACP,SAAS;AAAA,kBACT,SAAS,CAACC,SAAQ;AACjB,wBAAIA,KAAI,SAAS;AAChBD,oCAAAA,MAAI,YAAY;AAAA,oBACjB;AAAA,kBACD;AAAA,iBACA;AAAA,cACF;AAAA,YACD;AAAA,WACA;AAAA,QAEF;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IAED,gBAAgB,KAAK,OAAO;AAE3B,UAAI,MAAM;AAAA,QACT,UAAU;AAAA,QACV,SAAS,MAAM;AACdA,wBAAAA,iEAAY,cAAc;AAC1BA,wBAAAA,MAAI,UAAU;AAAA,YACb,SAAS;AAAA,YACT,YAAY;AAAA,UACb,CAAC;AACDA,wBAAG,MAAC,YAAW;AAAA,QACf;AAAA,QACD,MAAM,OAAK;AACVA,wBAAG,MAAC,YAAW;AACfA,wBAAAA,MAAI,UAAU;AAAA,YACb,SAAS;AAAA,YACT,YAAY;AAAA,UACb,CAAC;AAAA,QACF;AAAA;AAEDA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,MACR,CAAC;AACD,UAAI,UAAU,iBAAiB;AAC9BA,4BAAI,uBAAuB,GAAG;AAAA,aACxB;AACNA,4BAAI,uBAAuB,GAAG;AAAA,MAC/B;AAAA,IACD;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnIA,GAAG,WAAW,eAAe;"}