{"version":3,"file":"feedback.js","sources":["platforms/app-plus/feedback/feedback.vue","../../../../../Work-Tools/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGxhdGZvcm1zL2FwcC1wbHVzL2ZlZWRiYWNrL2ZlZWRiYWNrLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"page\">\r\n\t\t<view class=\"feedback-title\">\r\n\t\t\t<text>问题和意见</text>\r\n\t\t\t<text class=\"feedback-quick\" @tap=\"chooseMsg\">快速键入</text>\r\n\t\t</view>\r\n\t\t<view class=\"feedback-body\"><textarea placeholder=\"请详细描述你的问题和意见...\" v-model=\"sendDate.content\" class=\"feedback-textare\"></textarea></view>\r\n\t\t<view class=\"feedback-title\"><text>图片(选填,提供问题截图,总大小10M以下)</text></view>\r\n\t\t<view class=\"feedback-body feedback-uploader\">\r\n\t\t\t<view class=\"uni-uploader\">\r\n\t\t\t\t<view class=\"uni-uploader-head\">\r\n\t\t\t\t\t<view class=\"uni-uploader-title\">点击预览图片</view>\r\n\t\t\t\t\t<view class=\"uni-uploader-info\">{{ imageList.length }}/5</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"uni-uploader-body\">\r\n\t\t\t\t\t<view class=\"uni-uploader__files\">\r\n\t\t\t\t\t\t<block v-for=\"(image, index) in imageList\" :key=\"index\">\r\n\t\t\t\t\t\t\t<view class=\"uni-uploader__file\" style=\"position: relative;\">\r\n\t\t\t\t\t\t\t\t<image class=\"uni-uploader__img\" :src=\"image\" @tap=\"previewImage(index)\"></image>\r\n\t\t\t\t\t\t\t\t<view class=\"close-view\" @click=\"close(index)\">x</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t<view class=\"uni-uploader__input-box\" v-show=\"imageList.length < 5\"><view class=\"uni-uploader__input\" @tap=\"chooseImg\"></view></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"feedback-title\"><text>QQ/邮箱</text></view>\r\n\t\t<view class=\"feedback-body\"><input class=\"feedback-input\" v-model=\"sendDate.contact\" placeholder=\"(选填,方便我们联系你 )\" /></view>\r\n\t\t<view class=\"feedback-title feedback-star-view\">\r\n\t\t\t<text>应用评分</text>\r\n\t\t\t<view class=\"feedback-star-view\"><uni-rate v-model=\"sendDate.score\" color=\"#bbb\"></uni-rate></view>\r\n\t\t</view>\r\n\t\t<button type=\"default\" class=\"feedback-submit\" @tap=\"send\">提交</button>\r\n\t\t<view class=\"feedback-title\"><text>用户反馈的结果可在app打包后于DCloud开发者中心查看</text></view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmsgContents: ['界面显示错乱', '启动缓慢，卡出翔了', 'UI无法直视，丑哭了', '偶发性崩溃'],\r\n\t\t\tstars: [1, 2, 3, 4, 5],\r\n\t\t\timageList: [],\r\n\t\t\tsendDate: {\r\n\t\t\t\tscore: 0,\r\n\t\t\t\tcontent: '',\r\n\t\t\t\tcontact: ''\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\tonLoad() {\r\n\t\tthis.deviceInfo = {\r\n\t\t\t// appid: plus.runtime.appid,\r\n\t\t\tappid: '__UNI__5D0B0CA',\r\n\t\t\timei: plus.device.imei, //设备标识\r\n\t\t\tp: plus.os.name === 'Android' ? 'a' : 'i', //平台类型，i表示iOS平台，a表示Android平台。\r\n\t\t\tmd: plus.device.model, //设备型号\r\n\t\t\tapp_version: plus.runtime.version,\r\n\t\t\tplus_version: plus.runtime.innerVersion, //基座版本号\r\n\t\t\tos: plus.os.version,\r\n\t\t\tnet: '' + plus.networkinfo.getCurrentType()\r\n\t\t};\r\n\t\tthis.sendDate = Object.assign(this.deviceInfo, this.sendDate);\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 关闭图片\r\n\t\t * @param {Object} e\r\n\t\t */\r\n\t\tclose(e) {\r\n\t\t\tthis.imageList.splice(e, 1);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 快速输入\r\n\t\t */\r\n\t\tchooseMsg() {\r\n\t\t\tuni.showActionSheet({\r\n\t\t\t\titemList: this.msgContents,\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tthis.sendDate.content = this.msgContents[res.tapIndex];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 选择图片\r\n\t\t */\r\n\t\tchooseImg() {\r\n\t\t\t//选择图片\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tsourceType: ['camera', 'album'],\r\n\t\t\t\tsizeType: 'compressed',\r\n\t\t\t\tcount: 5 - this.imageList.length,\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tthis.imageList = this.imageList.concat(res.tempFilePaths);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 评分\r\n\t\t * @param {Object} e\r\n\t\t */\r\n\t\tchooseStar(e) {\r\n\t\t\t//点击评星\r\n\t\t\tthis.sendDate.score = e;\r\n\t\t},\r\n\t\t/**\r\n\t\t * 预览图片\r\n\t\t * @param {Object} index\r\n\t\t */\r\n\t\tpreviewImage(index) {\r\n\t\t\tuni.previewImage({\r\n\t\t\t\turls: this.imageList,\r\n\t\t\t\tcurrent: this.imageList[index]\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 提交\r\n\t\t */\r\n\t\tsend() {\r\n\t\t\t//发送反馈\r\n\t\t\tif (this.sendDate.content.length === 0) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\tcontent: '请输入问题和意见',\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '上传中...'\r\n\t\t\t});\r\n\t\t\tlet imgs = this.imageList.map((value, index) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tname: 'images' + index,\r\n\t\t\t\t\turi: value\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\t// TODO 服务端限制上传文件一次最大不超过 2M, 图片一次最多不超过5张\r\n\t\t\tthis.request(this.sendDate, imgs)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tif (typeof res.data === 'string') {\r\n\t\t\t\t\t\tres.data = JSON.parse(res.data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (res.statusCode === 200 && res.data && res.data.ret === 0) {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '反馈成功',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.imageList = [];\r\n\t\t\t\t\t\tthis.sendDate = Object.assign(this.deviceInfo, {\r\n\t\t\t\t\t\t\tscore: 0,\r\n\t\t\t\t\t\t\tcontent: '',\r\n\t\t\t\t\t\t\tcontact: ''\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (res.statusCode !== 200) {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '反馈失败，错误码为：' + res.statusCode,\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '反馈失败',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 发送请求到后台\r\n\t\t */\r\n\t\trequest(sendDate, imgs) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tlet fromData = {\r\n\t\t\t\t\turl: 'https://service.dcloud.net.cn/feedback',\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tresolve(res);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: res => {\r\n\t\t\t\t\t\treject(res);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (imgs.length > 0) {\r\n\t\t\t\t\tfromData.files = imgs;\r\n\t\t\t\t\tfromData.formData = sendDate;\r\n\t\t\t\t\tuni.uploadFile(fromData);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfromData.data = sendDate;\r\n\t\t\t\t\tfromData.method = 'POST';\r\n\t\t\t\t\tuni.request(fromData);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style>\r\npage {\r\n\tbackground-color: #efeff4;\r\n}\r\n\r\n.input-view {\r\n\tfont-size: 28rpx;\r\n}\r\n\r\n.close-view {\r\n\ttext-align: center;\r\n\tline-height: 14px;\r\n\theight: 16px;\r\n\twidth: 16px;\r\n\tborder-radius: 50%;\r\n\tbackground: #ff5053;\r\n\tcolor: #ffffff;\r\n\tposition: absolute;\r\n\ttop: -6px;\r\n\tright: -4px;\r\n\tfont-size: 12px;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/workspace/2025/wx/wx20250829/天天体验馆/platforms/app-plus/feedback/feedback.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}